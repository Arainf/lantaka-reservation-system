import{r as n,R as K,j as t}from"./index-D5vEyPHo.js";import{c as U,i as z}from"./lucide-D9gs9x5f.js";import{N as $,a as q}from"./NavigationTop-DyJ0_YrQ.js";import{R as H}from"./ReservationsTable-DE6fJQYy.js";import{B as J}from"./createLucideIcon-8mYcU7v_.js";import{B as P}from"./NotificationBell-BTbLSTBQ.js";import{D as Q}from"./deletemodal-vwdABMSc.js";import{b as X}from"./App-Djhw_SJK.js";import{S,a as w,b as C,c as N,d as o}from"./select-DQ9Ul_4x.js";import{I as Y}from"./input-2rwcTciZ.js";import{S as Z}from"./search-B77jdn07.js";import{R as ee}from"./refresh-cw-DRZkr8V2.js";import"./index-BhiIR7t5.js";import"./iconBase-Kpgs8Efe.js";import"./index-BGl0ELxP.js";import"./index-L6YSZLy6.js";import"./scroll-area-uXoW3jqd.js";import"./index-BxHjqAeQ.js";import"./separator-B0NTeVhd.js";import"./table-D_aKbOch.js";import"./dialog-C3s8z_XE.js";import"./Combination-CrfrviD1.js";import"./label-_-sDx8Dq.js";import"./toaster-DeKnBLXS.js";import"./toast-4AJFHnBj.js";import"./chevron-left-CITwkm69.js";import"./chevron-right-BAR7VKsc.js";import"./save-DRGOTJxu.js";import"./circle-plus-Dc_8mQmt.js";import"./index-ByrSLeMy.js";function Ee({sidebarOpen:R=!1,toggleSidebar:b=()=>{}}){const{reservationsData:T,fetchReservations:p,deleteData:_,saveNote:D}=X(),[i,f]=n.useState(""),[l,h]=n.useState({guest_type:"all",status:"all"}),[te,k]=n.useState(!1),g=n.useRef(null),[O,c]=n.useState(!1),[m,x]=n.useState(null),[E,F]=n.useState(0),[a,v]=n.useState({key:null,direction:"ascending"});n.useEffect(()=>{U({icons:z});const e=s=>{g.current&&!g.current.contains(s.target)&&k(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const I=n.useCallback(async()=>{await p(),F(e=>e+1)},[p]);n.useEffect(()=>{console.log("fetchReservations in parent"),I()},[_,D]);const j={waiting:1,ready:2,onUse:3,onCleaning:4,done:5,cancelled:6},u=T.filter(e=>{const s=e.guest_name.toLowerCase().includes(i.toLowerCase())||e.account_name.toLowerCase().includes(i.toLowerCase()),r=l.guest_type==="all"||e.guest_type===l.guest_type,V=l.status==="all"||e.status===l.status;return s&&r&&V}).sort((e,s)=>j[e.status]-j[s.status]);K.useMemo(()=>{let e=[...u];return a.key!==null&&e.sort((s,r)=>s[a.key]<r[a.key]?a.direction==="ascending"?-1:1:s[a.key]>r[a.key]?a.direction==="ascending"?1:-1:0),e.sort((s,r)=>s.status==="Waiting"&&r.status!=="Waiting"?-1:s.status!=="Waiting"&&r.status==="Waiting"?1:0)},[u,a]);const L=e=>{let s="ascending";a.key===e&&a.direction==="ascending"&&(s="descending"),v({key:e,direction:s})},M=e=>{x(e),c(!0)},A=()=>{console.log(`Deleting reservation for ${m.guest_name}`),c(!1),x(null)},y=(e,s)=>{h(r=>({...r,[e]:s}))},B=()=>{h({guest_type:"all",status:"all"}),f(""),v({key:null,direction:"ascending"})},W=["internal","external"],G=["waiting","confirmed","cancelled","onUse","onCleaning","done"],d=Object.entries(l).filter(([e,s])=>s!=="all");return t.jsxs("div",{className:"flex flex-row overflow-hidden relative w-screen h-screen bg-gray-100",children:[t.jsx($,{isOpen:R}),t.jsxs("div",{className:"flex-1 overflow-auto",children:[t.jsx(q,{onSidebarToggle:b}),t.jsxs("main",{className:"p-6 space-y-6",children:[t.jsx("h1",{className:"text-xl font-bold",children:"Reservations Management"}),t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Y,{type:"text",placeholder:"Search by name or account...",value:i,onChange:e=>f(e.target.value),className:"pl-10 pr-4 py-2 w-50 md:w-80"}),t.jsx("div",{className:"absolute inset-y-0 left-2 flex items-center pointer-events-none",children:t.jsx(Z,{className:"text-gray-900",size:18})})]}),t.jsxs(S,{value:l.guest_type,onValueChange:e=>y("guest_type",e),children:[t.jsx(w,{className:"w-[180px]",children:t.jsx(C,{placeholder:"Guest Type"})}),t.jsxs(N,{children:[t.jsx(o,{value:"all",children:"All Guest Types"}),W.map(e=>t.jsx(o,{value:e,children:e},e))]})]}),t.jsxs(S,{value:l.status,onValueChange:e=>y("status",e),children:[t.jsx(w,{className:"w-[180px]",children:t.jsx(C,{placeholder:"Status"})}),t.jsxs(N,{children:[t.jsx(o,{value:"all",children:"All Statuses"}),G.map(e=>t.jsx(o,{value:e,children:e},e))]})]}),(d.length>0||i)&&t.jsx(J,{variant:"ghost",onClick:B,title:"Reset all filters",children:t.jsx(ee,{className:"h-4 w-4"})})]})}),d.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:d.map(([e,s])=>t.jsx(P,{variant:"default",children:s},e))}),t.jsx("div",{children:t.jsx(H,{data:u,onDelete:M,onSort:L,sortConfig:a},E)})]})]}),t.jsx(Q,{isOpen:O,onClose:()=>c(!1),onConfirm:A,itemName:m?m.guest_name:"",itemType:"Reservation"})]})}export{Ee as default};
